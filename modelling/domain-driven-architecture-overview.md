
# Domain-Driven Architecture Overview

The core purpose of the application is to help users manage excess energy production (especially from renewables) by using it for Bitcoin mining. The system should automate this process, make it user-friendly, and potentially leverage the heat generated by the miners.

## Core Domain

*Defines the central problem the application solves.*

**What is the absolute central problem this application solves?**

It's the *optimization of energy usage* by integrating Bitcoin mining. This isn't just about mining; it's about using mining as *a tool* for energy management. The core domain revolves around the intelligent automation and control of mining based on energy availability and goals.

## Subdomain Classification

*Outlines the strategic categorization of subdomains  based on their importance to the system.*

- ðŸŸ¢â€‹ **Core:** The *automation/decision logic* is central. This is where the unique value proposition lies â€“ making smart decisions about *when* to mine based on energy conditions. Let's call this Energy Optimization & Mining Automation.
- ðŸŸ£ **Supporting:** These domains are necessary for the core domain to function but aren't the primary differentiator.
- âš« **Generic:** These are common problems solved elsewhere, not specific to this domain.

## Subdomain Components

*Breaks down each subdomain into its internal parts such as entities, value objects, and aggregates to clarify responsibilities and structure.*

- ðŸŸ¢ **Energy Optimization & Mining Automation** (Core):
  - `OptimizationPolicy`Â (Entity? Aggregate Root?): A collection of rules and goals driving the automation decisions. It makes decisions based on input (e.g. "*stabilizes hashrate*", "*battery health*" or "*heats the room*").
  - `AutomationRule`Â (Entity? Maybe Value Object within a Policy?): Represents a user-defined or system rule (e.g., "*turn on if battery > 80% AND forecast > X*"). TheÂ *logic*Â itself.
  - `EnergyStateSnapshot`Â (Value Object): Represents the state of the energy system at a point in time (*production*, *consumption*, *battery level*, *forecast*). Used as input for decisions.
  - `MiningDecision`Â (Value Object): The output of the policy (e.g., `StartMining`, `StopMining`, `MaintainState`, `ChangeState`).
  - `ForecastData`Â (Value Object): Represents the relevant solar/energy forecast.

- ðŸŸ£ **Energy System Monitoring** (Supporting):
  - `EnergyPlant`Â (Entity or Aggregate Root): Represents the overall energy production system.
  - `EnergySource`Â (Entity): e.g., Solar Panel Array, Wind Turbine. Has properties likeÂ `CurrentProduction`Â (VO).
  - `EnergyStorage`Â (Entity): e.g., Battery. Has properties likeÂ `StateOfCharge` (VO),Â `NominalCapacity`Â (VO), `ActualCapacity` (VO).
  - `EnergyLoad`Â (Entity): Represents the user's main energy load. Contains `CurrentConsumption` (VO)
  - `EnergyReading`Â (Value Object): A specific measurement (e.g., 5 kW production at timestamp T).

- ðŸŸ£ **Mining Device Management** (Supporting):
  - `Miner`Â (ASIC) (Entity): Represents a physical mining device. Has a `MinerId` (VO),Â `Status`Â (VO: *On, Off, Error*), maybeÂ `PowerConsumption`Â (VO).
  - `MiningFarm`Â (Entity? Aggregate Root? Optional): If managing multiple miners as a group.
  - `ControlCommand`Â (Value Object): e.g., `TurnOn`, `TurnOff`, `SetHashboard`.

- ðŸŸ£ **Heat Utilization** (Supporting):
  - (Potentially) `HeatOutput`Â (Value Object?): Associated with aÂ Miner's operation.
  - (Potentially) `HeatingZone`Â (Entity?): If actively managing heat distribution.
  - (Potentially) `TemperatureSensor`Â (Entity?): To monitor effectiveness.

- ðŸŸ£ **Mining Performance Analysis** (Supporting):
  - `MiningSession`Â (Entity?): Represents a period when a miner was active.
  - `MiningReward`Â (Value Object): Satoshi earned.
  - `HashRate`Â (Value Object): Mining speed.
  - `PoolConnectionDetails`Â (Value Object/Entity?): Details about the mining pool being used.

- ðŸŸ£ **Home Consumption Analytics** (Supporting):
  - `HomeLoadsProfile` (Aggregate Root): Represents the typical energy load profile of a household.
  - `LoadDevice` (Entity): Represents a specific energy load inside the home. Includes `ConsumptionForecast`.

- ðŸŸ£ **User Configuration & Interaction** (Supporting):
  - `User`Â (Entity): The system user.
  - `SystemSettings`Â (Entity/VO): Global or specific settings.
  - `NotificationPreference`Â (VO): Notification settings.

- ðŸŸ£ **External Integrations** (Supporting):
  - `ForecastProvider`Â (Interface/Adapter): Weather/solar forecast service.
  - (Potentially) `GridDataService`Â (Interface/Adapter): Grid pricing integration.

## Context Mapping: Subdomain Interactions

*Shows how different subdomains interact by exchanging information and triggering actions. This helps define the flow of responsibilities in the system.*

| From (Subdomain)                    | --> | To (Subdomain)                          | Data/Action Provided                              |
| ----------------------------------- | ----| --------------------------------------- | ------------------------------------------------- |
| Energy System Monitoring            | --> | Energy Optimization & Mining Automation | `EnergyStateSnapshot`                             |
| External Integrations (Forecast)    | --> | Energy Optimization & Mining Automation | `ForecastData`                                    |
| User Configuration & Interaction    | --> | Energy Optimization & Mining Automation | User parameters for `OptimizationPolicy`          |
| Energy Optimization & Mining Auto.  | --> | Mining Device Management                | `ControlCommand` (e.g., TurnOn Miner X)           |
| Mining Device Management            | --> | Energy Optimization & Mining Automation | Miner status reports                              |
| Mining Device Management            | --> | Mining Performance Analysis             | Uptime, possibly hashrate                         |
| External Integrations (Mining Pool) | --> | Mining Performance Analysis             | `MiningReward` data                               |
| Home Consumption Analytics          | --> | Energy Optimization & Mining Automation | Aggregate `ConsumptionForecast`                   |
| Monitoring Subdomains               | --> | User Configuration & Interaction        | Data for display (status, performance, heat, ...) |
